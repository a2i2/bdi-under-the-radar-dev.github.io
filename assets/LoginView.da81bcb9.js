import{f as C,h as q,x as n,z as M,H as N,I as U,k as E,c,J as Z,o as d,_ as I,u as z,K as j,j as m,F as T,e as l,L as D,l as h,m as w,A as V,M as F,N as K,O,p as H,b as G,P as J,n as P,D as Q,C as W}from"./index.1b69821f.js";var $={},X=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-*\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;$.validate=function(e){if(!e||e.length>254)return!1;var v=X.test(e);if(!v)return!1;var u=e.split("@");if(u[0].length>64)return!1;var o=u[1].split(".");return!o.some(function(r){return r.length>63})};const Y=["autofocus"],ee=C({__name:"TextInput",props:{modelValue:null,autofocus:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:v}){const u=e,o=q({get(){return u.modelValue},set(t){v("update:modelValue",t)}}),r=n();return M(()=>{var t;u.autofocus&&((t=r.value)==null||t.focus())}),(t,s)=>N((d(),c("input",{ref_key:"inputRef",ref:r,"onUpdate:modelValue":s[0]||(s[0]=a=>Z(o)?o.value=a:null),class:"text-input",autofocus:e.autofocus},null,8,Y)),[[U,E(o)]])}});const L=I(ee,[["__scopeId","data-v-ddb28ffe"]]),B=e=>(H("data-v-61675b3b"),e=e(),G(),e),te=["onSubmit","onKeyup"],se=B(()=>l("h2",null,"Under The Radar",-1)),oe={class:"lp-email-text"},ae={class:"lp-input-area"},le={key:0,class:"lp-error utr-text-caption"},ne={key:1,class:"lp-error"},ue={class:"lp-button-row"},re={class:"lp-verification-text"},ie=B(()=>l("span",null,"An email with your verification code has been sent to",-1)),ce={class:"lp-email"},de={class:"lp-input-area"},ve={key:0,class:"lp-error"},me={key:1,class:"lp-error"},pe={class:"lp-button-row"},_e=B(()=>l("div",{class:"lp-no-code-text"}," If you haven't received an email, you can request a new code or re-enter your email address. ",-1)),fe={class:"lp-button-row"},be=C({__name:"LoginPanel",props:{email:null,codeRequested:{type:Boolean},isBusy:{type:Boolean},submissionError:null,requestError:null},emits:["requestCode","submitCode"],setup(e,{emit:v}){var A;const u=e;P(k=>({b82132fa:E(R)}));const o=z(),r=5,t=n(""),s=n((A=u.email)!=null?A:""),a=n(""),p=n(!1),i=n(u.codeRequested?"enter-code":"enter-email");async function y(){v("requestCode",s.value),i.value="enter-code",p.value=!0;try{await O(r*1e3)}finally{p.value=!1}}function S(){v("submitCode",s.value,t.value)}function g(){i.value=="enter-email"?y():S()}function _(){console.log("onEscape"),i.value=="enter-code"&&(i.value="enter-email")}j(s,k=>{$.validate(k)?a.value="":a.value="Please enter a valid email address"},{immediate:!0});const b=q(()=>!!(s.value&&!a.value)),R=q(()=>o.breakpoint==="mobile"?"row":"column");return(k,f)=>(d(),c("form",{class:"login-panel",onSubmit:F(g,["prevent"]),onKeyup:K(_,["esc"])},[m(J,{height:"128px","large-logo":!0}),se,i.value=="enter-email"?(d(),c(T,{key:0},[l("div",oe,[D(" Enter your email to sign in "),l("div",ae,[m(L,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=x=>s.value=x),autofocus:"",placeholder:"yours@example.com"},null,8,["modelValue"]),a.value?(d(),c("div",le,h(a.value),1)):w("",!0),e.requestError?(d(),c("div",ne,h(e.requestError),1)):w("",!0)])]),l("div",ue,[m(V,{class:"lp-button",label:"SUBMIT",type:"submit",icon:"chevron-right","justify-content":"center","text-class":"utr-text-h3",disabled:!E(b)},null,8,["disabled"])])],64)):(d(),c(T,{key:1},[l("div",re,[ie,l("div",ce,h(s.value),1),l("div",de,[m(L,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=x=>t.value=x),class:"lp-input-code",autofocus:"",placeholder:"000000",size:"6"},null,8,["modelValue"]),e.requestError?(d(),c("div",ve,h(e.requestError),1)):w("",!0),e.submissionError?(d(),c("div",me,h(e.submissionError),1)):w("",!0)])]),l("div",pe,[m(V,{class:"lp-button",label:"SUBMIT",type:"submit","justify-content":"center","text-class":"utr-text-h3",disabled:e.isBusy,icon:"chevron-right"},null,8,["disabled"])]),_e,l("div",fe,[m(V,{class:"lp-button",label:"Resend Code","justify-content":"center","text-class":"utr-text-h4",disabled:e.isBusy||p.value,icon:"lock",onClick:y},null,8,["disabled"]),m(V,{class:"lp-button",label:"Re-enter Email","justify-content":"center","text-class":"utr-text-h4",icon:"undo",onClick:f[2]||(f[2]=x=>i.value="enter-email")})])],64))],40,te))}});const he=I(be,[["__scopeId","data-v-61675b3b"]]),ye={class:"login-view"},ge=C({__name:"LoginView",setup(e){var g;P(_=>({d64f599a:E(S)}));const v=z(),u=W(),o=Q(),r=n((g=o.email.value)!=null?g:""),t=n(!1),s=n(!1),a=n(""),p=n("");async function i(_){s.value=!0,a.value="";try{t.value=!0,await o.startPasswordlessLogin(_)}catch{a.value="An error occurred while requesting a code"}finally{t.value=!1}}async function y(_,b){p.value="";try{t.value=!0,await o.submitOTP(b,_),u.push(o.getRouterTargetForHomeOrLoginIfNeeded())}catch{p.value="An error occurred while submitting the code"}finally{t.value=!1}}r.value&&i(r.value);const S=q(()=>v.breakpoint==="mobile"?"1rem 0.5rem":"2rem");return(_,b)=>(d(),c("div",ye,[m(he,{email:r.value,"code-requested":s.value,"is-busy":t.value,"submission-error":p.value,"request-error":a.value,onSubmitCode:y,onRequestCode:i},null,8,["email","code-requested","is-busy","submission-error","request-error"])]))}});const we=I(ge,[["__scopeId","data-v-91ae559e"]]);export{we as default};
